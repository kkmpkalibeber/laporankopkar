<!doctype html>
<html lang="id" class="h-full">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <title>Laporan Tutup Buku - KOPKAR ATTA'AWUN</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="/_sdk/data_sdk.js"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&amp;family=Playfair+Display:wght@700&amp;display=swap" rel="stylesheet">
  <style>
    body {
      box-sizing: border-box;
      font-family: 'Inter', sans-serif;
      -webkit-tap-highlight-color: transparent;
      -webkit-font-smoothing: antialiased;
    }
    .font-display {
      font-family: 'Playfair Display', serif;
    }
    .gradient-primary {
      background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
    }
    .gradient-success {
      background: linear-gradient(135deg, #059669 0%, #047857 100%);
    }
    .glass-card {
      background: rgba(255, 255, 255, 0.98);
      backdrop-filter: blur(20px);
    }
    .stat-card {
      background: linear-gradient(145deg, #ffffff 0%, #f8fafc 100%);
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }
    .stat-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
    }
    .btn-primary {
      background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
      transition: all 0.3s ease;
    }
    .btn-primary:hover, .btn-primary:active {
      background: linear-gradient(135deg, #1d4ed8 0%, #1e40af 100%);
      transform: translateY(-1px);
      box-shadow: 0 6px 15px rgba(37, 99, 235, 0.4);
    }
    .btn-success {
      background: linear-gradient(135deg, #059669 0%, #047857 100%);
    }
    .btn-success:hover, .btn-success:active {
      background: linear-gradient(135deg, #047857 0%, #065f46 100%);
      box-shadow: 0 6px 15px rgba(5, 150, 105, 0.4);
    }
    .data-table th {
      background: #0f172a;
      color: white;
    }
    .data-table tr:nth-child(even) {
      background: #f8fafc;
    }
    .data-table tr:hover {
      background: #dbeafe;
    }
    .toast {
      animation: slideIn 0.4s cubic-bezier(0.4, 0, 0.2, 1), fadeOut 0.4s ease 2.6s forwards;
    }
    @keyframes slideIn {
      from { transform: translateX(120%); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }
    @keyframes fadeOut {
      from { opacity: 1; }
      to { opacity: 0; pointer-events: none; }
    }
    .login-bg {
      background: linear-gradient(135deg, #0f172a 0%, #1e3a8a 50%, #1e293b 100%);
    }
    .floating {
      animation: float 6s ease-in-out infinite;
    }
    @keyframes float {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-10px); }
    }
    .modal-backdrop {
      background: rgba(15, 23, 42, 0.9);
      backdrop-filter: blur(8px);
    }
    .print-section {
      background: white;
      color: #1f2937;
    }
    .print-preview-modal {
      background: rgba(15, 23, 42, 0.98);
      backdrop-filter: blur(10px);
    }
    .print-preview-content {
      width: 90%;
      max-width: 210mm;
      min-height: 297mm;
      background: white;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
      border-radius: 8px;
      overflow: hidden;
    }
    
    /* Mobile Optimizations */
    @media (max-width: 768px) {
      .stat-card {
        padding: 1rem !important;
      }
      .glass-card {
        padding: 1.5rem !important;
        border-radius: 1rem !important;
      }
      .btn-primary, .btn-success {
        padding: 0.75rem 1rem !important;
        font-size: 0.9rem !important;
      }
      .data-table {
        font-size: 0.8rem;
      }
      .data-table th, .data-table td {
        padding: 0.75rem 0.5rem !important;
      }
      .print-preview-content {
        width: 95%;
        min-height: auto;
        max-height: 80vh;
        overflow-y: auto;
      }
    }
    
    @media (max-width: 480px) {
      .grid-cols-1 {
        grid-template-columns: 1fr !important;
      }
      .grid-cols-2 {
        grid-template-columns: repeat(2, 1fr) !important;
      }
      .text-2xl {
        font-size: 1.5rem !important;
      }
      .text-3xl {
        font-size: 1.75rem !important;
      }
      .text-4xl {
        font-size: 2rem !important;
      }
    }
    
    /* Touch-friendly buttons */
    button, [role="button"], input[type="submit"] {
      min-height: 44px;
      min-width: 44px;
    }
    
    input, select, textarea {
      font-size: 16px !important; /* Prevent zoom on iOS */
    }
    
    /* Print Styles */
    @media print {
      body * {
        visibility: hidden;
      }
      #print-preview-container, #print-preview-container * {
        visibility: visible;
      }
      #print-preview-container {
        position: absolute;
        left: 0;
        top: 0;
        width: 100%;
        box-shadow: none;
        border-radius: 0;
        margin: 0;
        padding: 0;
      }
      .no-print {
        display: none !important;
      }
      @page {
        size: A4;
        margin: 10mm;
      }
    }
    
    /* Scrollbar styling */
    ::-webkit-scrollbar {
      width: 8px;
      height: 8px;
    }
    ::-webkit-scrollbar-track {
      background: #f1f1f1;
      border-radius: 4px;
    }
    ::-webkit-scrollbar-thumb {
      background: #c1c1c1;
      border-radius: 4px;
    }
    ::-webkit-scrollbar-thumb:hover {
      background: #a1a1a1;
    }
  </style>
</head>
<body class="h-full">
  <div id="app" class="h-full overflow-auto">
    <!-- Toast Container -->
    <div id="toast-container" class="fixed top-4 right-4 z-50 flex flex-col gap-2 max-w-xs"></div>
    
    <!-- Login Screen -->
    <div id="login-screen" class="login-bg h-full flex items-center justify-center p-4">
      <div class="w-full max-w-md">
        <div class="text-center mb-8 floating">
          <div class="w-20 h-20 bg-gradient-success rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-xl">
            <svg class="w-12 h-12 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
          </div>
          <h1 id="login-org-name" class="text-3xl font-display font-bold text-white mb-2">KOPKAR ATTA'AWUN</h1>
          <p id="login-report-title" class="text-emerald-300 text-base font-medium">Laporan Tutup Buku Th. 2025</p>
        </div>
        
        <div class="glass-card rounded-2xl shadow-xl p-6">
          <h2 class="text-xl font-bold text-gray-800 mb-4 text-center">Selamat Datang</h2>
          <form id="login-form" onsubmit="handleLogin(event)">
            <div class="mb-4">
              <label for="user-type" class="block text-sm font-semibold text-gray-700 mb-1">Masuk Sebagai</label>
              <select id="user-type" class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:ring-2 focus:ring-blue-100 transition-all text-gray-700 font-medium appearance-none">
                <option value="admin">Administrator</option>
                <option value="member">Anggota Koperasi</option>
              </select>
            </div>
            
            <div class="mb-4">
              <label for="password" class="block text-sm font-semibold text-gray-700 mb-1">Password</label>
              <div class="relative">
                <input type="password" id="password" class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:ring-2 focus:ring-blue-100 transition-all text-gray-700 font-medium" placeholder="Masukkan password" required>
                <button type="button" onclick="togglePassword()" class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 p-1">
                  <svg id="eye-icon" class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
                  </svg>
                </button>
              </div>
            </div>
            
            <div class="bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4">
              <p class="text-blue-800 text-xs font-medium">üîê <span class="font-bold">Password Anggota:</span> kopkarjaya</p>
            </div>
            
            <button type="submit" class="btn-primary w-full px-4 py-3 text-white rounded-lg font-bold shadow-lg active:scale-95 transition-transform">
              Masuk
            </button>
          </form>
        </div>
        
        <p class="text-center text-white/70 text-xs mt-4">¬© 2025 KOPKAR ATTA'AWUN. All rights reserved.</p>
      </div>
    </div>
    
    <!-- Main Application -->
    <div id="main-app" class="hidden h-full gradient-primary">
      <!-- Header -->
      <header class="bg-white/10 backdrop-blur-xl border-b border-white/20 sticky top-0 z-40">
        <div class="max-w-7xl mx-auto px-4 py-3">
          <div class="flex items-center justify-between">
            <div class="flex items-center gap-3">
              <div class="w-10 h-10 bg-gradient-success rounded-xl flex items-center justify-center shadow-lg">
                <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                </svg>
              </div>
              <div>
                <h1 id="header-title" class="text-lg font-display font-bold text-white truncate">Laporan Tutup Buku Th. 2025</h1>
                <p id="header-org" class="text-emerald-300 text-xs font-semibold truncate">KOPKAR ATTA'AWUN</p>
              </div>
            </div>
            
            <div class="flex items-center gap-2">
              <div class="text-right hidden sm:block">
                <p class="text-white/70 text-xs font-medium">Masuk sebagai</p>
                <p id="user-badge" class="text-white font-bold text-sm"></p>
              </div>
              <button onclick="logout()" class="px-3 py-2 bg-white/10 hover:bg-white/20 text-white rounded-lg font-semibold transition-all flex items-center gap-1 active:scale-95">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewbox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
                </svg>
                <span class="hidden sm:inline">Keluar</span>
              </button>
            </div>
          </div>
        </div>
      </header>
      
      <!-- Main Content -->
      <main class="max-w-7xl mx-auto px-4 py-4">
        <!-- Admin Panel -->
        <div id="admin-panel" class="hidden">
          <div class="glass-card rounded-2xl shadow-xl p-6 mb-6">
            <div class="flex items-center gap-3 mb-6">
              <div class="w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center">
                <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewbox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
                </svg>
              </div>
              <div>
                <h2 class="text-xl font-bold text-gray-800">Sumber Data</h2>
                <p class="text-gray-500 text-sm font-medium">Data diambil langsung dari Google Sheets</p>
              </div>
            </div>
            
            <div class="bg-gradient-to-r from-blue-50 to-indigo-50 border-2 border-blue-300 rounded-xl p-4 mb-4">
              <p class="text-blue-900 font-semibold text-sm mb-2">üìä Google Sheets URL:</p>
              <code class="text-xs text-blue-800 bg-white/70 px-2 py-1 rounded block font-mono break-all">
                https://docs.google.com/spreadsheets/d/e/2PACX-1vTgF6TOXUEU5lkes0myZTiEnI1LhmWx_kD73RordpVoviaHsO_ih58oPJz6IJnFxdOoMgaE0ncoch_-/pub?gid=0&single=true&output=csv
              </code>
              <p class="text-blue-700 text-xs mt-2">‚úÖ Data diperbarui otomatis</p>
              <p class="text-blue-800 text-xs mt-1 font-semibold">üîÑ Klik Refresh untuk memperbarui data sekarang</p>
            </div>
            
            <div class="flex flex-wrap gap-3">
              <button onclick="refreshData()" class="btn-primary px-4 py-3 text-white rounded-lg font-bold shadow-lg flex items-center gap-2 active:scale-95">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
                </svg>
                Refresh Data
              </button>
            </div>
          </div>
          
          <!-- Data Table -->
          <div class="glass-card rounded-2xl shadow-xl p-6">
            <div class="flex items-center justify-between mb-6">
              <div class="flex items-center gap-3">
                <div class="w-12 h-12 bg-emerald-100 rounded-xl flex items-center justify-center">
                  <svg class="w-6 h-6 text-emerald-600" fill="none" stroke="currentColor" viewbox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                  </svg>
                </div>
                <div>
                  <h2 class="text-xl font-bold text-gray-800">Data Anggota</h2>
                  <p id="admin-count" class="text-gray-500 text-sm font-medium">0 data terdaftar</p>
                </div>
              </div>
            </div>
            
            <div class="overflow-x-auto rounded-xl border-2 border-gray-200">
              <table class="data-table w-full text-sm">
                <thead>
                  <tr>
                    <th class="px-3 py-3 text-left font-bold text-xs">ID Anggota</th>
                    <th class="px-3 py-3 text-left font-bold text-xs">Nama</th>
                    <th class="px-3 py-3 text-right font-bold text-xs">Simpanan</th>
                    <th class="px-3 py-3 text-right font-bold text-xs">Piutang</th>
                    <th class="px-3 py-3 text-right font-bold text-xs">SS</th>
                    <th class="px-3 py-3 text-right font-bold text-xs">Tab Harian</th>
                    <th class="px-3 py-3 text-right font-bold text-xs">SHR</th>
                    <th class="px-3 py-3 text-right font-bold text-xs">SHU Diterima</th>
                  </tr>
                </thead>
                <tbody id="admin-table-body">
                  <tr>
                    <td colspan="8" class="px-3 py-12 text-center text-gray-400">
                      <div class="flex flex-col items-center gap-2">
                        <svg class="w-12 h-12 text-gray-300" fill="none" stroke="currentColor" viewbox="0 0 24 24">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                        </svg>
                        <span class="font-medium text-sm">Tidak ada data. Klik Refresh untuk mengambil data.</span>
                      </div>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        
        <!-- Member Panel -->
        <div id="member-panel" class="hidden">
          <!-- Summary Statistics -->
          <div class="grid grid-cols-2 lg:grid-cols-5 gap-3 mb-6">
            <div class="stat-card rounded-xl p-4 shadow border border-gray-100">
              <div class="flex items-center gap-2 mb-3">
                <div class="w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center">
                  <svg class="w-5 h-5 text-blue-600" fill="none" stroke="currentColor" viewbox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0z" />
                  </svg>
                </div>
              </div>
              <p class="text-gray-500 text-xs font-bold uppercase tracking-wider mb-1">Total Anggota</p>
              <p id="stat-members" class="text-xl font-bold text-gray-800">0</p>
            </div>
            
            <div class="stat-card rounded-xl p-4 shadow border border-gray-100">
              <div class="flex items-center gap-2 mb-3">
                <div class="w-10 h-10 bg-emerald-100 rounded-lg flex items-center justify-center">
                  <svg class="w-5 h-5 text-emerald-600" fill="none" stroke="currentColor" viewbox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1" />
                  </svg>
                </div>
              </div>
              <p class="text-gray-500 text-xs font-bold uppercase tracking-wider mb-1">Total Asset</p>
              <p id="stat-asset" class="text-lg font-bold text-emerald-600">Rp 0</p>
            </div>
            
            <div class="stat-card rounded-xl p-4 shadow border border-gray-100 hidden sm:block">
              <div class="flex items-center gap-2 mb-3">
                <div class="w-10 h-10 bg-cyan-100 rounded-lg flex items-center justify-center">
                  <svg class="w-5 h-5 text-cyan-600" fill="none" stroke="currentColor" viewbox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6" />
                  </svg>
                </div>
              </div>
              <p class="text-gray-500 text-xs font-bold uppercase tracking-wider mb-1">Total Pendapatan</p>
              <p id="stat-income" class="text-lg font-bold text-cyan-600">Rp 0</p>
            </div>
            
            <div class="stat-card rounded-xl p-4 shadow border border-gray-100 hidden sm:block">
              <div class="flex items-center gap-2 mb-3">
                <div class="w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center">
                  <svg class="w-5 h-5 text-red-600" fill="none" stroke="currentColor" viewbox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 17h8m0 0V9m0 8l-8-8-4 4-6-6" />
                  </svg>
                </div>
              </div>
              <p class="text-gray-500 text-xs font-bold uppercase tracking-wider mb-1">Total Beban</p>
              <p id="stat-expense" class="text-lg font-bold text-red-600">Rp 0</p>
            </div>
            
            <div class="stat-card rounded-xl p-4 shadow border border-gray-100 bg-gradient-to-br from-emerald-50 to-white col-span-2 sm:col-span-1">
              <div class="flex items-center gap-2 mb-3">
                <div class="w-10 h-10 bg-emerald-600 rounded-lg flex items-center justify-center shadow">
                  <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                  </svg>
                </div>
              </div>
              <p class="text-gray-600 text-xs font-bold uppercase tracking-wider mb-1">SHU Th 2025</p>
              <p id="stat-shu" class="text-lg font-bold text-emerald-700">Rp 0</p>
            </div>
          </div>
          
          <!-- Search Section -->
          <div class="glass-card rounded-2xl shadow-xl p-6 mb-6">
            <div class="flex items-center gap-3 mb-4">
              <div class="w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center">
                <svg class="w-6 h-6 text-purple-600" fill="none" stroke="currentColor" viewbox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                </svg>
              </div>
              <div>
                <h2 class="text-xl font-bold text-gray-800">Pencarian Data Anggota</h2>
                <p class="text-gray-500 text-sm font-medium">Cari berdasarkan nama anggota</p>
              </div>
            </div>
            
            <div class="relative">
              <input type="text" id="search-input" onkeyup="searchMember()" class="w-full px-4 py-3 pl-12 border-2 border-gray-300 rounded-lg text-gray-700 font-medium focus:border-purple-500 focus:ring-2 focus:ring-purple-100 transition-all" placeholder="Ketik nama anggota...">
              <div class="absolute left-4 top-1/2 -translate-y-1/2 text-gray-400">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                </svg>
              </div>
            </div>
            
            <div id="search-results" class="mt-4 space-y-2 max-h-64 overflow-y-auto"></div>
          </div>
          
          <!-- Member Detail -->
          <div id="member-detail" class="hidden"></div>
        </div>
      </main>
    </div>
    
    <!-- Print Preview Modal -->
    <div id="print-preview-modal" class="fixed inset-0 z-50 hidden print-preview-modal overflow-auto">
      <div class="min-h-screen py-4 px-2">
        <div class="max-w-5xl mx-auto">
          <div class="flex justify-between items-center mb-4 no-print">
            <h2 class="text-xl font-bold text-white">Preview Cetak</h2>
            <div class="flex gap-2">
              <button onclick="executePrint()" class="btn-success px-4 py-2 text-white rounded-lg font-bold shadow flex items-center gap-2 active:scale-95">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewbox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z" />
                </svg>
                Cetak
              </button>
              <button onclick="closePrintPreview()" class="px-4 py-2 bg-white/10 hover:bg-white/20 text-white rounded-lg font-bold transition-all active:scale-95">
                Tutup
              </button>
            </div>
          </div>
          <div id="print-preview-container" class="print-preview-content mx-auto">
            <!-- Print content will be inserted here -->
          </div>
          <div class="text-center mt-4 no-print">
            <p class="text-white/70 text-xs">Format: 1 Halaman A4</p>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Loading Overlay -->
    <div id="loading-overlay" class="fixed inset-0 z-50 hidden bg-gradient-to-br from-slate-900/90 to-blue-900/90 backdrop-blur-sm flex items-center justify-center">
      <div class="bg-white rounded-2xl p-8 flex flex-col items-center gap-4 shadow-xl mx-4">
        <div class="w-12 h-12 border-4 border-emerald-200 border-t-emerald-600 rounded-full animate-spin"></div>
        <p id="loading-text" class="text-gray-700 font-bold">Memproses...</p>
      </div>
    </div>
  </div>
  
  <script>
    // ==================== CONFIGURATION ====================
    let allMembers = [];
    let currentUser = null;
    let config = {};

    const defaultConfig = {
      report_title: 'Laporan Tutup Buku Th. 2025',
      organization_name: 'KOPKAR ATTA\'AWUN',
      year_period: '2025',
      total_asset: 'Rp. 1.207.995.657',
      total_income: 'Rp. 171.080.552',
      total_expense: 'Rp. 59.470.945',
      shu_2025: 'Rp. 111.609.607',
      primary_color: '#0f172a',
      secondary_color: '#059669',
      accent_color: '#2563eb',
      text_color: '#1f2937',
      background_color: '#f8fafc',
      font_family: 'Inter'
    };

    // Google Sheets URL
    const GOOGLE_SHEETS_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vTgF6TOXUEU5lkes0myZTiEnI1LhmWx_kD73RordpVoviaHsO_ih58oPJz6IJnFxdOoMgaE0ncoch_-/pub?gid=0&single=true&output=csv';

    // ==================== CSV PARSER ====================
    function parseCSV(csvText) {
      const rows = [];
      let currentRow = [];
      let currentField = '';
      let insideQuotes = false;
      
      for (let i = 0; i < csvText.length; i++) {
        const char = csvText[i];
        
        if (char === '"') {
          if (insideQuotes && csvText[i + 1] === '"') {
            currentField += '"';
            i++;
          } else {
            insideQuotes = !insideQuotes;
          }
          continue;
        }
        
        if (char === ',' && !insideQuotes) {
          currentRow.push(currentField);
          currentField = '';
          continue;
        }
        
        if (char === '\n' && !insideQuotes) {
          currentRow.push(currentField);
          rows.push(currentRow);
          currentRow = [];
          currentField = '';
          continue;
        }
        
        if (char === '\r') continue;
        
        currentField += char;
      }
      
      if (currentField !== '' || currentRow.length > 0) {
        currentRow.push(currentField);
        rows.push(currentRow);
      }
      
      return rows;
    }

    // ==================== MAIN DATA FETCH ====================
    async function fetchDataFromGoogleSheets() {
      showLoading('Mengambil data dari Google Sheets...');
      
      try {
        const response = await fetch(GOOGLE_SHEETS_URL);
        const csvText = await response.text();
        
        const rows = parseCSV(csvText);
        
        if (rows.length === 0) {
          hideLoading();
          showToast('Tidak ada data ditemukan', 'warning');
          return;
        }
        
        const members = [];
        
        for (let i = 1; i < rows.length; i++) {
          const row = rows[i];
          
          if (row.length === 0 || (row.length === 1 && row[0] === '')) {
            continue;
          }
          
          const member = {
            record_type: 'member',
            __backendId: `member_${i}`,
            id_anggota: (row[0] || '').trim(),
            nama: (row[1] || '').trim(),
            simpanan: (row[2] || '0').trim(),
            piutang: (row[3] || '0').trim(),
            ss: (row[4] || '0').trim(),
            tab_harian: (row[5] || '0').trim(),
            shr: (row[6] || '0').trim(),
            shu_diterima: (row[7] || '0').trim()
          };
          
          if (member.id_anggota && member.nama) {
            members.push(member);
          }
        }
        
        allMembers = members;
        updateUI();
        hideLoading();
        
        if (members.length > 0) {
          showToast(`Berhasil mengambil ${members.length} data anggota`, 'success');
        }
        
      } catch (error) {
        hideLoading();
        console.error('Error fetching data:', error);
        showToast('Gagal mengambil data dari Google Sheets', 'error');
      }
    }

    // ==================== APPLICATION FUNCTIONS ====================
    async function init() {
      config = { ...defaultConfig };
      applyConfig();
      await fetchDataFromGoogleSheets();
      setInterval(fetchDataFromGoogleSheets, 2 * 60 * 1000);
    }

    function applyConfig() {
      const title = config.report_title || defaultConfig.report_title;
      const org = config.organization_name || defaultConfig.organization_name;
      const font = config.font_family || defaultConfig.font_family;

      document.querySelectorAll('#header-title, #login-report-title').forEach(el => el.textContent = title);
      document.querySelectorAll('#header-org, #login-org-name').forEach(el => el.textContent = org);
      document.body.style.fontFamily = `${font}, 'Inter', sans-serif`;
    }

    function handleLogin(event) {
      event.preventDefault();
      
      const userType = document.getElementById('user-type').value;
      const password = document.getElementById('password').value;

      const credentials = {
        'admin': 'f4150l',
        'member': 'kopkarjaya'
      };

      if (password.toLowerCase() !== credentials[userType].toLowerCase()) {
        showToast('Password salah! Silakan coba lagi.', 'error');
        return;
      }

      currentUser = userType;
      document.getElementById('login-screen').classList.add('hidden');
      document.getElementById('main-app').classList.remove('hidden');

      if (userType === 'admin') {
        document.getElementById('admin-panel').classList.remove('hidden');
        document.getElementById('member-panel').classList.add('hidden');
        document.getElementById('user-badge').textContent = 'Administrator';
      } else {
        document.getElementById('admin-panel').classList.add('hidden');
        document.getElementById('member-panel').classList.remove('hidden');
        document.getElementById('user-badge').textContent = 'Anggota Koperasi';
      }

      showToast(`Selamat datang, ${userType === 'admin' ? 'Administrator' : 'Anggota'}!`, 'success');
      updateUI();
    }

    function togglePassword() {
      const input = document.getElementById('password');
      const icon = document.getElementById('eye-icon');
      
      if (input.type === 'password') {
        input.type = 'text';
        icon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"/>';
      } else {
        input.type = 'password';
        icon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>';
      }
    }

    function logout() {
      currentUser = null;
      document.getElementById('main-app').classList.add('hidden');
      document.getElementById('login-screen').classList.remove('hidden');
      document.getElementById('password').value = '';
      document.getElementById('member-detail').classList.add('hidden');
      document.getElementById('search-input').value = '';
      showToast('Anda telah keluar', 'info');
    }

    async function refreshData() {
      await fetchDataFromGoogleSheets();
    }

    function updateUI() {
      if (currentUser === 'admin') {
        updateAdminTable();
      } else {
        updateMemberStats();
      }
    }

    function updateMemberStats() {
      const totalMembers = allMembers.length;
      document.getElementById('stat-members').textContent = totalMembers.toLocaleString('id-ID');
      document.getElementById('stat-asset').textContent = config.total_asset || defaultConfig.total_asset;
      document.getElementById('stat-income').textContent = config.total_income || defaultConfig.total_income;
      document.getElementById('stat-expense').textContent = config.total_expense || defaultConfig.total_expense;
      document.getElementById('stat-shu').textContent = config.shu_2025 || defaultConfig.shu_2025;
    }

    function updateAdminTable() {
      const tbody = document.getElementById('admin-table-body');
      const count = document.getElementById('admin-count');

      count.textContent = `${allMembers.length} data terdaftar`;

      if (allMembers.length === 0) {
        tbody.innerHTML = `
          <tr>
            <td colspan="8" class="px-3 py-12 text-center text-gray-400">
              <div class="flex flex-col items-center gap-2">
                <svg class="w-12 h-12 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                </svg>
                <span class="font-medium text-sm">Tidak ada data. Klik Refresh untuk mengambil data.</span>
              </div>
            </td>
          </tr>
        `;
        return;
      }

      tbody.innerHTML = allMembers.map(m => `
        <tr class="border-b border-gray-100">
          <td class="px-3 py-3 text-gray-700 font-medium text-xs">${m.id_anggota}</td>
          <td class="px-3 py-3 text-gray-800 font-semibold text-sm">${m.nama}</td>
          <td class="px-3 py-3 text-right text-gray-700 text-sm">${m.simpanan}</td>
          <td class="px-3 py-3 text-right text-gray-700 text-sm">${m.piutang}</td>
          <td class="px-3 py-3 text-right text-gray-700 text-sm">${m.ss}</td>
          <td class="px-3 py-3 text-right text-gray-700 text-sm">${m.tab_harian}</td>
          <td class="px-3 py-3 text-right text-gray-700 text-sm">${m.shr}</td>
          <td class="px-3 py-3 text-right font-semibold text-emerald-600 text-sm">${m.shu_diterima}</td>
        </tr>
      `).join('');
    }

    function searchMember() {
      const query = document.getElementById('search-input').value.toLowerCase().trim();
      const resultsContainer = document.getElementById('search-results');

      if (!query) {
        resultsContainer.innerHTML = '';
        return;
      }

      const filtered = allMembers.filter(m => 
        m.nama.toLowerCase().includes(query) || 
        m.id_anggota.toLowerCase().includes(query)
      );

      if (filtered.length === 0) {
        resultsContainer.innerHTML = `
          <div class="text-center py-8 text-gray-400">
            <svg class="w-12 h-12 mx-auto mb-3 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
            </svg>
            <p class="font-medium text-sm">Tidak ada hasil untuk "${query}"</p>
          </div>
        `;
        return;
      }

      resultsContainer.innerHTML = filtered.map(m => `
        <button onclick="showMemberDetail('${m.__backendId}')" class="w-full bg-white hover:bg-blue-50 border border-gray-200 hover:border-blue-400 rounded-lg p-4 transition-all text-left group active:scale-[0.98]">
          <div class="flex items-center justify-between">
            <div class="flex items-center gap-3">
              <div class="w-10 h-10 bg-gradient-to-br from-emerald-400 to-emerald-600 rounded-lg flex items-center justify-center shadow">
                <span class="text-white font-bold">${m.nama.charAt(0).toUpperCase()}</span>
              </div>
              <div>
                <p class="font-bold text-gray-800 group-hover:text-blue-600 text-sm">${m.nama}</p>
                <p class="text-gray-500 text-xs">ID: ${m.id_anggota}</p>
              </div>
            </div>
            <svg class="w-5 h-5 text-gray-400 group-hover:text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
            </svg>
          </div>
        </button>
      `).join('');
    }

    function showMemberDetail(id) {
      const member = allMembers.find(m => m.__backendId === id);
      if (!member) return;

      const detailContainer = document.getElementById('member-detail');
      
      detailContainer.innerHTML = `
        <div class="glass-card rounded-2xl shadow-xl overflow-hidden print-section">
          <div class="bg-gradient-to-r from-emerald-600 to-emerald-700 px-4 py-6 no-print">
            <div class="flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-4">
              <div class="flex items-center gap-4">
                <div class="w-16 h-16 bg-white/20 rounded-xl flex items-center justify-center backdrop-blur-sm">
                  <span class="text-2xl font-bold text-white">${member.nama.charAt(0).toUpperCase()}</span>
                </div>
                <div>
                  <h3 class="text-xl font-bold text-white mb-1">${member.nama}</h3>
                  <p class="text-emerald-100 text-sm">ID Anggota: ${member.id_anggota}</p>
                </div>
              </div>
              <button onclick="printPreview('${id}')" class="btn-success px-4 py-3 text-white rounded-lg font-bold shadow flex items-center gap-2 active:scale-95 self-start">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"/>
                </svg>
                Cetak Laporan
              </button>
            </div>
          </div>

          <div class="p-4">
            <h4 class="text-xs font-bold text-gray-500 uppercase tracking-wider mb-4">Rincian Simpanan & Tabungan</h4>
            <div class="grid grid-cols-2 sm:grid-cols-4 gap-3 mb-6">
              <div class="bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg p-4 border border-blue-200">
                <p class="text-blue-700 text-xs font-bold mb-1">Simpanan</p>
                <p class="text-lg font-bold text-blue-900">${member.simpanan}</p>
              </div>
              <div class="bg-gradient-to-br from-orange-50 to-orange-100 rounded-lg p-4 border border-orange-200">
                <p class="text-orange-700 text-xs font-bold mb-1">Piutang</p>
                <p class="text-lg font-bold text-orange-900">${member.piutang}</p>
              </div>
              <div class="bg-gradient-to-br from-purple-50 to-purple-100 rounded-lg p-4 border border-purple-200">
                <p class="text-purple-700 text-xs font-bold mb-1">SS</p>
                <p class="text-lg font-bold text-purple-900">${member.ss}</p>
              </div>
              <div class="bg-gradient-to-br from-cyan-50 to-cyan-100 rounded-lg p-4 border border-cyan-200">
                <p class="text-cyan-700 text-xs font-bold mb-1">Tabungan Harian</p>
                <p class="text-lg font-bold text-cyan-900">${member.tab_harian}</p>
              </div>
            </div>

            <h4 class="text-xs font-bold text-gray-500 uppercase tracking-wider mb-4">Pendapatan & Bagi Hasil</h4>
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 mb-6">
              <div class="bg-gradient-to-br from-teal-50 to-teal-100 rounded-lg p-5 border border-teal-200">
                <p class="text-teal-700 text-xs font-bold mb-2">SHR</p>
                <p class="text-xl font-bold text-teal-900">${member.shr}</p>
              </div>
              <div class="bg-gradient-to-br from-emerald-100 to-emerald-200 rounded-lg p-5 border-2 border-emerald-400 shadow">
                <p class="text-emerald-800 text-xs font-bold mb-2">SHU Diterima</p>
                <p class="text-2xl font-bold text-emerald-900">${member.shu_diterima}</p>
              </div>
            </div>
          </div>
        </div>
      `;

      detailContainer.classList.remove('hidden');
      detailContainer.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }

    // ==================== SINGLE PAGE PRINT FUNCTIONS ====================
    function printPreview(memberId) {
      const member = allMembers.find(m => m.__backendId === memberId);
      if (!member) {
        showToast('Data anggota tidak ditemukan', 'error');
        return;
      }
      
      const previewContainer = document.getElementById('print-preview-container');
      previewContainer.innerHTML = createCompactPrintContent(member);
      
      document.getElementById('print-preview-modal').classList.remove('hidden');
      document.body.style.overflow = 'hidden';
    }

    function createCompactPrintContent(member) {
      const printDate = new Date().toLocaleDateString('id-ID', {
        day: 'numeric',
        month: 'long',
        year: 'numeric'
      });
      
      return `
        <div class="p-6 print-content" style="font-family: 'Inter', sans-serif; max-height: 297mm;">
          <!-- Header Compact -->
          <div class="text-center mb-4">
            <h1 class="text-xl font-bold text-gray-800">KOPKAR ATTA'AWUN</h1>
            <h2 class="text-lg text-emerald-600 font-semibold">Laporan Tutup Buku Th. 2025</h2>
            <p class="text-sm text-gray-600">Tahun 2025</p>
          </div>
          
          <!-- Member Info Compact -->
          <div class="mb-4 p-3 bg-gray-50 rounded border border-gray-200">
            <div class="flex justify-between">
              <div>
                <p class="text-xs text-gray-600">Nama Anggota</p>
                <p class="font-bold text-gray-800">${member.nama}</p>
              </div>
              <div>
                <p class="text-xs text-gray-600">ID Anggota</p>
                <p class="font-bold text-gray-800">${member.id_anggota}</p>
              </div>
            </div>
          </div>
          
          <!-- Simpanan & Tabungan Compact -->
          <div class="mb-4">
            <h3 class="text-sm font-bold text-gray-700 mb-2 border-b pb-1">RINCIAN SIMPANAN & TABUNGAN</h3>
            <div class="grid grid-cols-2 gap-2">
              <div class="p-2 border border-blue-200 rounded bg-blue-50">
                <p class="text-xs font-semibold text-blue-700">Simpanan</p>
                <p class="text-sm font-bold">${member.simpanan}</p>
              </div>
              <div class="p-2 border border-orange-200 rounded bg-orange-50">
                <p class="text-xs font-semibold text-orange-700">Piutang</p>
                <p class="text-sm font-bold">${member.piutang}</p>
              </div>
              <div class="p-2 border border-purple-200 rounded bg-purple-50">
                <p class="text-xs font-semibold text-purple-700">SS</p>
                <p class="text-sm font-bold">${member.ss}</p>
              </div>
              <div class="p-2 border border-cyan-200 rounded bg-cyan-50">
                <p class="text-xs font-semibold text-cyan-700">Tabungan Harian</p>
                <p class="text-sm font-bold">${member.tab_harian}</p>
              </div>
            </div>
          </div>
          
          <!-- Pendapatan & Bagi Hasil Compact -->
          <div class="mb-4">
            <h3 class="text-sm font-bold text-gray-700 mb-2 border-b pb-1">PENDAPATAN & BAGI HASIL</h3>
            <div class="grid grid-cols-2 gap-3">
              <div class="p-3 border border-teal-200 rounded bg-teal-50">
                <p class="text-xs font-semibold text-teal-700">SHR</p>
                <p class="text-base font-bold">${member.shr}</p>
              </div>
              <div class="p-3 border-2 border-emerald-400 rounded bg-emerald-50">
                <p class="text-xs font-semibold text-emerald-700">SHU Diterima</p>
                <p class="text-lg font-bold text-emerald-900">${member.shu_diterima}</p>
              </div>
            </div>
          </div>
          
          <!-- Kesimpulan Compact -->
          <div class="mb-4 p-3 border border-blue-300 rounded bg-blue-50">
            <h4 class="text-sm font-bold text-blue-800 mb-2">KESIMPULAN</h4>
            <p class="text-xs text-gray-700 mb-2">Koperasi ini menunjukkan kinerja keuangan yang sehat dengan:</p>
            <ul class="text-xs text-gray-700 space-y-1">
              <li>‚Ä¢ Profitabilitas tinggi (Margin SHU 65,24%)</li>
              <li>‚Ä¢ Solvabilitas excellent (EAR 50,57%)</li>
              <li>‚Ä¢ Likuiditas aman (Quick Ratio 1,95)</li>
              <li>‚Ä¢ Kemandirian finansial 100%</li>
            </ul>
          </div>
          
          <!-- Tanda Tangan Compact -->
          <div class="mt-6 pt-4 border-t border-gray-300">
            <div class="grid grid-cols-3 gap-2 text-center">
              <div>
                <p class="text-xs text-gray-600 mb-6">Ketua Koperasi</p>
                <div class="border-t border-gray-800 pt-1">
                  <p class="text-xs font-bold">Mohamad Fatkhurrohman</p>
                </div>
              </div>
              <div>
                <p class="text-xs text-gray-600 mb-6">Bendahara</p>
                <div class="border-t border-gray-800 pt-1">
                  <p class="text-xs font-bold">Hasta Dwi Utami</p>
                </div>
              </div>
              <div>
                <p class="text-xs text-gray-600 mb-6">Anggota</p>
                <div class="border-t border-gray-800 pt-1">
                  <p class="text-xs font-bold">${member.nama}</p>
                </div>
              </div>
            </div>
            <p class="text-center text-xs text-gray-500 mt-4">Dicetak: ${printDate}</p>
          </div>
        </div>
      `;
    }

    function closePrintPreview() {
      document.getElementById('print-preview-modal').classList.add('hidden');
      document.body.style.overflow = 'auto';
    }

    function executePrint() {
      const printContent = document.getElementById('print-preview-container');
      if (!printContent) {
        showToast('Tidak ada konten untuk dicetak', 'error');
        return;
      }
      
      const printWindow = window.open('', '_blank');
      if (!printWindow) {
        showToast('Izinkan pop-up untuk mencetak', 'error');
        return;
      }
      
      const printHTML = `
        <!DOCTYPE html>
        <html>
        <head>
          <meta charset="UTF-8">
          <title>Laporan Anggota - KOPKAR ATTA'AWUN</title>
          <style>
            @page {
              size: A4;
              margin: 10mm;
            }
            body {
              font-family: 'Inter', sans-serif;
              margin: 0;
              padding: 15px;
              color: #1f2937;
              font-size: 11pt;
              line-height: 1.4;
            }
            .print-content {
              max-width: 190mm;
              margin: 0 auto;
            }
            .text-center { text-align: center; }
            .text-xs { font-size: 9pt; }
            .text-sm { font-size: 10pt; }
            .text-base { font-size: 11pt; }
            .text-lg { font-size: 12pt; }
            .text-xl { font-size: 13pt; }
            .font-bold { font-weight: 700; }
            .font-semibold { font-weight: 600; }
            .mb-2 { margin-bottom: 0.5rem; }
            .mb-3 { margin-bottom: 0.75rem; }
            .mb-4 { margin-bottom: 1rem; }
            .mb-6 { margin-bottom: 1.5rem; }
            .mt-4 { margin-top: 1rem; }
            .mt-6 { margin-top: 1.5rem; }
            .p-2 { padding: 0.5rem; }
            .p-3 { padding: 0.75rem; }
            .p-4 { padding: 1rem; }
            .rounded { border-radius: 0.25rem; }
            .border { border: 1px solid; }
            .border-2 { border: 2px solid; }
            .border-t { border-top: 1px solid; }
            .grid { display: grid; }
            .grid-cols-2 { grid-template-columns: repeat(2, 1fr); }
            .grid-cols-3 { grid-template-columns: repeat(3, 1fr); }
            .gap-2 { gap: 0.5rem; }
            .gap-3 { gap: 0.75rem; }
            .bg-blue-50 { background-color: #eff6ff; }
            .bg-orange-50 { background-color: #fff7ed; }
            .bg-purple-50 { background-color: #faf5ff; }
            .bg-cyan-50 { background-color: #ecfeff; }
            .bg-teal-50 { background-color: #f0fdfa; }
            .bg-emerald-50 { background-color: #ecfdf5; }
            .bg-gray-50 { background-color: #f9fafb; }
            .border-blue-200 { border-color: #bfdbfe; }
            .border-orange-200 { border-color: #fed7aa; }
            .border-purple-200 { border-color: #e9d5ff; }
            .border-cyan-200 { border-color: #a5f3fc; }
            .border-teal-200 { border-color: #99f6e4; }
            .border-emerald-400 { border-color: #34d399; }
            .border-gray-200 { border-color: #e5e7eb; }
            .border-gray-300 { border-color: #d1d5db; }
            .border-gray-800 { border-color: #1f2937; }
            .text-blue-700 { color: #1d4ed8; }
            .text-blue-800 { color: #1e40af; }
            .text-orange-700 { color: #c2410c; }
            .text-purple-700 { color: #7e22ce; }
            .text-cyan-700 { color: #0e7490; }
            .text-teal-700 { color: #0f766e; }
            .text-emerald-700 { color: #047857; }
            .text-emerald-900 { color: #064e3b; }
            .text-gray-600 { color: #4b5563; }
            .text-gray-700 { color: #374151; }
            .text-gray-800 { color: #1f2937; }
            ul { margin: 0; padding-left: 1rem; }
            li { margin-bottom: 0.25rem; }
          </style>
        </head>
        <body>
          ${printContent.innerHTML}
          <script>
            window.onload = function() {
              setTimeout(function() {
                window.print();
                setTimeout(function() {
                  window.close();
                }, 500);
              }, 300);
            };
          <\/script>
        </body>
        </html>
      `;
      
      printWindow.document.open();
      printWindow.document.write(printHTML);
      printWindow.document.close();
      
      showToast('Membuka dialog cetak...', 'info');
    }

    // ==================== UTILITY FUNCTIONS ====================
    function showToast(message, type = 'info') {
      const container = document.getElementById('toast-container');
      const toast = document.createElement('div');
      
      const colors = {
        success: 'bg-emerald-600',
        error: 'bg-red-600',
        warning: 'bg-amber-600',
        info: 'bg-blue-600'
      };

      const icons = {
        success: '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>',
        error: '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"/>',
        warning: '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>',
        info: '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>'
      };

      toast.className = `toast ${colors[type]} text-white px-4 py-3 rounded-lg shadow-lg font-semibold text-sm flex items-center gap-2`;
      toast.innerHTML = `
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">${icons[type]}</svg>
        <span>${message}</span>
      `;
      
      container.appendChild(toast);
      setTimeout(() => {
        toast.style.opacity = '0';
        toast.style.transform = 'translateX(100%)';
        setTimeout(() => toast.remove(), 300);
      }, 3000);
    }

    function showLoading(text = 'Memproses...') {
      document.getElementById('loading-text').textContent = text;
      document.getElementById('loading-overlay').classList.remove('hidden');
    }

    function hideLoading() {
      document.getElementById('loading-overlay').classList.add('hidden');
    }

    // ==================== START APPLICATION ====================
    init();
  </script>
</body>
</html>
